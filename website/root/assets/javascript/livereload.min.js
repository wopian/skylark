(function(){var s,q,y={};s={};var H,I,J,v,w,z,m,A=[].indexOf||function(b){for(var a=0,c=this.length;a<c;a++)if(a in this&&this[a]===b)return a;return-1};s=v="http://livereload.com/protocols/official-6";q=w="http://livereload.com/protocols/official-7";m=function(){return function(b,a){this.message="LiveReload protocol error ("+b+') after receiving data: "'+a+'".'}}();var B;z=z=function(){function b(a){this.handlers=a;this.reset()}b.prototype.reset=function(){return this.protocol=null};b.prototype.process=
function(a){var c,f,b,d;try{if(null==this.protocol){if(a.match(/^!!ver:([\d.]+)$/))this.protocol=6;else if(f=this._parseMessage(a,["hello"]))if(f.protocols.length)if(0<=A.call(f.protocols,w))this.protocol=7;else if(0<=A.call(f.protocols,v))this.protocol=6;else throw new m("no supported protocols found");else throw new m("no protocols specified in handshake message");return this.handlers.connected(this.protocol)}if(6===this.protocol){f=JSON.parse(a);if(!f.length)throw new m("protocol 6 messages must be arrays");
c=f[0];b=f[1];if("refresh"!==c)throw new m("unknown protocol 6 command");return this.handlers.message({command:"reload",path:b.path,liveCSS:null!=(d=b.apply_css_live)?d:!0})}f=this._parseMessage(a,["reload","alert"]);return this.handlers.message(f)}catch(g){if(g instanceof m)return this.handlers.error(g);throw g;}};b.prototype._parseMessage=function(a,c){var f,b;try{f=JSON.parse(a)}catch(d){throw new m("unparsable JSON",a);}if(!f.command)throw new m('missing "command" key',a);if(b=f.command,0>A.call(c,
b))throw new m("invalid command '"+f.command+"', only valid commands are: "+c.join(", ")+")",a);return f};return b}();v=s;w=q;q=B=function(){function b(a,c,f,b){var d=this;this.options=a;this.WebSocket=c;this.Timer=f;this.handlers=b;this._uri="ws://"+this.options.host+":"+this.options.port+"/livereload";this._nextDelay=this.options.mindelay;this._connectionDesired=!1;this.protocol=0;this.protocolParser=new z({connected:function(a){d.protocol=a;d._handshakeTimeout.stop();d._nextDelay=d.options.mindelay;
d._disconnectionReason="broken";return d.handlers.connected(a)},error:function(a){d.handlers.error(a);return d._closeOnError()},message:function(a){return d.handlers.message(a)}});this._handshakeTimeout=new f(function(){if(d._isSocketConnected())return d._disconnectionReason="handshake-timeout",d.socket.close()});this._reconnectTimer=new f(function(){if(d._connectionDesired)return d.connect()});this.connect()}b.prototype._isSocketConnected=function(){return this.socket&&this.socket.readyState===this.WebSocket.OPEN};
b.prototype.connect=function(){var a=this;this._connectionDesired=!0;if(!this._isSocketConnected())return this._reconnectTimer.stop(),this._disconnectionReason="cannot-connect",this.protocolParser.reset(),this.handlers.connecting(),this.socket=new this.WebSocket(this._uri),this.socket.onopen=function(c){return a._onopen(c)},this.socket.onclose=function(c){return a._onclose(c)},this.socket.onmessage=function(c){return a._onmessage(c)},this.socket.onerror=function(c){return a._onerror(c)}};b.prototype.disconnect=
function(){this._connectionDesired=!1;this._reconnectTimer.stop();if(this._isSocketConnected())return this._disconnectionReason="manual",this.socket.close()};b.prototype._scheduleReconnection=function(){if(this._connectionDesired&&!this._reconnectTimer.running)return this._reconnectTimer.start(this._nextDelay),this._nextDelay=Math.min(this.options.maxdelay,2*this._nextDelay)};b.prototype.sendCommand=function(a){if(null!=this.protocol)return this._sendCommand(a)};b.prototype._sendCommand=function(a){return this.socket.send(JSON.stringify(a))};
b.prototype._closeOnError=function(){this._handshakeTimeout.stop();this._disconnectionReason="error";return this.socket.close()};b.prototype._onopen=function(a){this.handlers.socketConnected();this._disconnectionReason="handshake-failed";a={command:"hello",protocols:[v,w],ver:"2.0.8"};this.options.ext&&(a.ext=this.options.ext);this.options.extver&&(a.extver=this.options.extver);this.options.snipver&&(a.snipver=this.options.snipver);this._sendCommand(a);return this._handshakeTimeout.start(this.options.handshake_timeout)};
b.prototype._onclose=function(a){this.protocol=0;this.handlers.disconnected(this._disconnectionReason,this._nextDelay);return this._scheduleReconnection()};b.prototype._onerror=function(a){};b.prototype._onmessage=function(a){return this.protocolParser.process(a.data)};return b}();var p;p={bind:function(b,a,c){if(b.addEventListener)return b.addEventListener(a,c,!1);if(b.attachEvent)return b[a]=1,b.attachEvent("onpropertychange",function(f){if(f.propertyName===a)return c()});throw Error("Attempt to attach custom event "+
a+" to something which isn't a DOMElement");},fire:function(b,a){var c;if(b.addEventListener)return c=document.createEvent("HTMLEvents"),c.initEvent(a,!0,!0),document.dispatchEvent(c);if(b.attachEvent){if(b[a])return b[a]++}else throw Error("Attempt to fire custom event "+a+" on something which isn't a DOMElement");}};y.bind=p.bind;y.fire=p.fire;s=function(){function b(a,c){this.window=a;this.host=c}b.identifier="less";b.version="1.0";b.prototype.reload=function(a,c){if(this.window.less&&this.window.less.refresh){if(a.match(/\.less$/i))return this.reloadLess(a);
if(c.originalPath.match(/\.less$/i))return this.reloadLess(c.originalPath)}return!1};b.prototype.reloadLess=function(a){var c,f,b,d;b=document.getElementsByTagName("link");d=[];c=0;for(f=b.length;c<f;c++)a=b[c],(a.href&&"stylesheet/less"===a.rel||a.rel.match(/stylesheet/)&&a.type.match(/^text\/(x-)?less$/))&&d.push(a);if(0===d.length)return!1;c=0;for(f=d.length;c<f;c++)a=d[c],a.href=this.host.generateCacheBustUrl(a.href);this.host.console.log("LiveReload is asking LESS to recompile all stylesheets");
this.window.less.refresh(!0);return!0};b.prototype.analyze=function(){return{disable:!(!this.window.less||!this.window.less.refresh)}};return b}();var r;H=r=function(){function b(a){var c=this;this.func=a;this.running=!1;this.id=null;this._handler=function(){c.running=!1;c.id=null;return c.func()}}b.prototype.start=function(a){this.running&&clearTimeout(this.id);this.id=setTimeout(this._handler,a);return this.running=!0};b.prototype.stop=function(){if(this.running)return clearTimeout(this.id),this.running=
!1,this.id=null};return b}();r.start=function(b,a){return setTimeout(a,b)};var t;I=t=function(){function b(){this.host=null;this.port=35729;this.extver=this.ext=this.snipver=null;this.mindelay=1E3;this.maxdelay=6E4;this.handshake_timeout=5E3}b.prototype.set=function(a,c){switch(typeof this[a]){case "undefined":break;case "number":return this[a]=+c;default:return this[a]=c}};return b}();t.extract=function(b){var a,c,f,e,d,g;g=b.getElementsByTagName("script");e=0;for(d=g.length;e<d;e++)if(b=g[e],(f=
b.src)&&(c=f.match(/^[^:]+:\/\/(.*)\/z?livereload\.js(?:\?(.*))?$/))){f=new t;if(b=c[1].match(/^([^\/:]+)(?::(\d+))?$/))f.host=b[1],b[2]&&(f.port=parseInt(b[2],10));if(c[2])for(d=c[2].split("&"),b=0,e=d.length;b<e;b++)c=d[b],1<(a=c.split("=")).length&&f.set(a[0].replace(/-/g,"_"),a.slice(1).join("="));return f}return null};var u,C,D,x,E,K,F;F=function(b){var a,c,f;0<=(c=b.indexOf("#"))?(a=b.slice(c),b=b.slice(0,c)):a="";0<=(c=b.indexOf("?"))?(f=b.slice(c),b=b.slice(0,c)):f="";return{url:b,params:f,
hash:a}};x=function(b){b=F(b).url;b=0===b.indexOf("file://")?b.replace(/^file:\/\/(localhost)?/,""):b.replace(/^([^:]+:)?\/\/([^:\/]+)(:\d*)?\//,"/");return decodeURIComponent(b)};K=function(b,a,c){var f,e,d,g,h;f={score:0};g=0;for(h=a.length;g<h;g++)e=a[g],d=D(b,c(e)),d>f.score&&(f={object:e,score:d});return 0<f.score?f:null};D=function(b,a){var c,f,e,d;b=b.replace(/^\/+/,"").toLowerCase();a=a.replace(/^\/+/,"").toLowerCase();if(b===a)return 1E4;c=b.split("/").reverse();f=a.split("/").reverse();
d=Math.min(c.length,f.length);for(e=0;e<d&&c[e]===f[e];)++e;return e};E=function(b,a){return 0<D(b,a)};u=[{selector:"background",styleNames:["backgroundImage"]},{selector:"border",styleNames:["borderImage","webkitBorderImage","MozBorderImage"]}];J=C=function(){function b(a,c,f){this.window=a;this.console=c;this.Timer=f;this.document=this.window.document;this.importCacheWaitPeriod=200;this.plugins=[]}b.prototype.addPlugin=function(a){return this.plugins.push(a)};b.prototype.analyze=function(a){return results};
b.prototype.reload=function(a,c){var f,b,d,g;this.options=c;null==(f=this.options).stylesheetReloadTimeout&&(f.stylesheetReloadTimeout=15E3);g=this.plugins;b=0;for(d=g.length;b<d;b++)if(f=g[b],f.reload&&f.reload(a,c))return;if(!(c.liveCSS&&a.match(/\.css$/i)&&this.reloadStylesheet(a)))if(c.liveImg&&a.match(/\.(jpe?g|png|gif)$/i))this.reloadImages(a);else return this.reloadPage()};b.prototype.reloadPage=function(){return this.window.document.location.reload()};b.prototype.reloadImages=function(a){var c,
b,e,d,g,h,k,l;c=this.generateUniqueString();e=this.document.images;d=0;for(h=e.length;d<h;d++)b=e[d],E(a,x(b.src))&&(b.src=this.generateCacheBustUrl(b.src,c));if(this.document.querySelectorAll)for(d=0,h=u.length;d<h;d++)for(e=u[d],b=e.selector,e=e.styleNames,l=this.document.querySelectorAll("[style*="+b+"]"),g=0,k=l.length;g<k;g++)b=l[g],this.reloadStyleImages(b.style,e,a,c);if(this.document.styleSheets){e=this.document.styleSheets;g=[];d=0;for(h=e.length;d<h;d++)b=e[d],g.push(this.reloadStylesheetImages(b,
a,c));return g}};b.prototype.reloadStylesheetImages=function(a,c,b){var e,d,g,h,k,l;try{e=null!=a?a.cssRules:void 0}catch(m){}if(e)for(g=0,k=e.length;g<k;g++)switch(a=e[g],a.type){case CSSRule.IMPORT_RULE:this.reloadStylesheetImages(a.styleSheet,c,b);break;case CSSRule.STYLE_RULE:h=0;for(l=u.length;h<l;h++)d=u[h].styleNames,this.reloadStyleImages(a.style,d,c,b);break;case CSSRule.MEDIA_RULE:this.reloadStylesheetImages(a,c,b)}};b.prototype.reloadStyleImages=function(a,c,b,e){var d,g,h,k,l,m=this;k=
0;for(l=c.length;k<l;k++)g=c[k],h=a[g],"string"===typeof h&&(d=h.replace(/\burl\s*\(([^)]*)\)/,function(a,c){return E(b,x(c))?"url("+m.generateCacheBustUrl(c,e)+")":a}),d!==h&&(a[g]=d))};b.prototype.reloadStylesheet=function(a){var c,b,e,d,g,h,k,l=this;e=function(){var a,c,d,e;d=this.document.getElementsByTagName("link");e=[];a=0;for(c=d.length;a<c;a++)b=d[a],"stylesheet"!==b.rel||b.__LiveReload_pendingRemoval||e.push(b);return e}.call(this);c=[];k=this.document.getElementsByTagName("style");g=0;
for(h=k.length;g<h;g++)d=k[g],d.sheet&&this.collectImportedStylesheets(d,d.sheet,c);d=0;for(g=e.length;d<g;d++)b=e[d],this.collectImportedStylesheets(b,b.sheet,c);if(this.window.StyleFix&&this.document.querySelectorAll)for(k=this.document.querySelectorAll("style[data-href]"),g=0,h=k.length;g<h;g++)d=k[g],e.push(d);this.console.log("LiveReload found "+e.length+" LINKed stylesheets, "+c.length+" @imported stylesheets");if(c=K(a,e.concat(c),function(a){return x(l.linkHref(a))}))c.object.rule?(this.console.log("LiveReload is reloading imported stylesheet: "+
c.object.href),this.reattachImportedRule(c.object)):(this.console.log("LiveReload is reloading stylesheet: "+this.linkHref(c.object)),this.reattachStylesheetLink(c.object));else for(this.console.log("LiveReload will reload all stylesheets because path '"+a+"' did not match any specific one"),a=0,c=e.length;a<c;a++)b=e[a],this.reattachStylesheetLink(b);return!0};b.prototype.collectImportedStylesheets=function(a,c,b){var e,d,g,h;try{d=null!=c?c.cssRules:void 0}catch(k){}if(d&&d.length)for(c=g=0,h=d.length;g<
h;c=++g)switch(e=d[c],e.type){case CSSRule.CHARSET_RULE:continue;case CSSRule.IMPORT_RULE:b.push({link:a,rule:e,index:c,href:e.href}),this.collectImportedStylesheets(a,e.styleSheet,b)}};b.prototype.waitUntilCssLoads=function(a,c){var b,e,d,g=this;b=!1;e=function(){if(!b)return b=!0,c()};a.onload=function(){g.console.log("LiveReload: the new stylesheet has finished loading");g.knownToSupportCssOnLoad=!0;return e()};this.knownToSupportCssOnLoad||(d=function(){return a.sheet?(g.console.log("LiveReload is polling until the new CSS finishes loading..."),
e()):g.Timer.start(50,d)})();return this.Timer.start(this.options.stylesheetReloadTimeout,e)};b.prototype.linkHref=function(a){return a.href||a.getAttribute("data-href")};b.prototype.reattachStylesheetLink=function(a){var c,b,e=this;if(!a.__LiveReload_pendingRemoval)return a.__LiveReload_pendingRemoval=!0,"STYLE"===a.tagName?(c=this.document.createElement("link"),c.rel="stylesheet",c.media=a.media,c.disabled=a.disabled):c=a.cloneNode(!1),c.href=this.generateCacheBustUrl(this.linkHref(a)),b=a.parentNode,
b.lastChild===a?b.appendChild(c):b.insertBefore(c,a.nextSibling),this.waitUntilCssLoads(c,function(){var b;b=/AppleWebKit/.test(navigator.userAgent)?5:200;return e.Timer.start(b,function(){var b;if(a.parentNode)return a.parentNode.removeChild(a),c.onreadystatechange=null,null!=(b=e.window.StyleFix)?b.link(c):void 0})})};b.prototype.reattachImportedRule=function(a){var b,f,e,d,g,h,k,l=this;h=a.rule;f=a.index;a=a.link;g=h.parentStyleSheet;b=this.generateCacheBustUrl(h.href);e=h.media.length?[].join.call(h.media,
", "):"";d='@import url("'+b+'") '+e+";";h.__LiveReload_newHref=b;k=this.document.createElement("link");k.rel="stylesheet";k.href=b;k.__LiveReload_pendingRemoval=!0;a.parentNode&&a.parentNode.insertBefore(k,a);return this.Timer.start(this.importCacheWaitPeriod,function(){k.parentNode&&k.parentNode.removeChild(k);if(h.__LiveReload_newHref===b)return g.insertRule(d,f),g.deleteRule(f+1),h=g.cssRules[f],h.__LiveReload_newHref=b,l.Timer.start(l.importCacheWaitPeriod,function(){if(h.__LiveReload_newHref===
b)return g.insertRule(d,f),g.deleteRule(f+1)})})};b.prototype.generateUniqueString=function(){return"livereload="+Date.now()};b.prototype.generateCacheBustUrl=function(a,b){var f,e,d;null==b&&(b=this.generateUniqueString());e=F(a);a=e.url;f=e.hash;e=e.params;this.options.overrideURL&&0>a.indexOf(this.options.serverURL)&&(d=a,a=this.options.serverURL+this.options.overrideURL+"?url="+encodeURIComponent(a),this.console.log("LiveReload is overriding source URL "+d+" with "+a));d=e.replace(/(\?|&)livereload=(\d+)/,
function(a,d){return""+d+b});d===e&&(d=0===e.length?"?"+b:""+e+"&"+b);return a+d+f};return b}();var n;B=q;r=H;t=I;C=J;q=n=function(){function b(a){var b=this;this.window=a;this.listeners={};this.plugins=[];this.pluginIdentifiers={};this.console=this.window.location.href.match(/LR-verbose/)&&this.window.console&&this.window.console.log&&this.window.console.error?this.window.console:{log:function(){},error:function(){}};(this.WebSocket=this.window.WebSocket||this.window.MozWebSocket)?(this.options=
t.extract(this.window.document))?(this.reloader=new C(this.window,this.console,r),this.connector=new B(this.options,this.WebSocket,r,{connecting:function(){},socketConnected:function(){},connected:function(a){var e;"function"===typeof(e=b.listeners).connect&&e.connect();b.log("LiveReload is connected to "+b.options.host+":"+b.options.port+" (protocol v"+a+").");return b.analyze()},error:function(a){return a instanceof m?console.log(""+a.message+"."):console.log("LiveReload internal error: "+a.message)},
disconnected:function(a,e){var d;"function"===typeof(d=b.listeners).disconnect&&d.disconnect();switch(a){case "cannot-connect":return b.log("LiveReload cannot connect to "+b.options.host+":"+b.options.port+", will retry in "+e+" sec.");case "broken":return b.log("LiveReload disconnected from "+b.options.host+":"+b.options.port+", reconnecting in "+e+" sec.");case "handshake-timeout":return b.log("LiveReload cannot connect to "+b.options.host+":"+b.options.port+" (handshake timeout), will retry in "+
e+" sec.");case "handshake-failed":return b.log("LiveReload cannot connect to "+b.options.host+":"+b.options.port+" (handshake failed), will retry in "+e+" sec.");case "manual":break;case "error":break;default:return b.log("LiveReload disconnected from "+b.options.host+":"+b.options.port+" ("+a+"), reconnecting in "+e+" sec.")}},message:function(a){switch(a.command){case "reload":return b.performReload(a);case "alert":return b.performAlert(a)}}})):console.error("LiveReload disabled because it could not find its own <SCRIPT> tag"):
console.error("LiveReload disabled because the browser does not seem to support web sockets")}b.prototype.on=function(a,b){return this.listeners[a]=b};b.prototype.log=function(a){return this.console.log(""+a)};b.prototype.performReload=function(a){var b,f;this.log("LiveReload received reload request: "+JSON.stringify(a,null,2));return this.reloader.reload(a.path,{liveCSS:null!=(b=a.liveCSS)?b:!0,liveImg:null!=(f=a.liveImg)?f:!0,originalPath:a.originalPath||"",overrideURL:a.overrideURL||"",serverURL:"http://"+
this.options.host+":"+this.options.port})};b.prototype.performAlert=function(a){return alert(a.message)};b.prototype.shutDown=function(){var a;this.connector.disconnect();this.log("LiveReload disconnected.");return"function"===typeof(a=this.listeners).shutdown?a.shutdown():void 0};b.prototype.hasPlugin=function(a){return!!this.pluginIdentifiers[a]};b.prototype.addPlugin=function(a){var b=this;this.hasPlugin(a.identifier)||(this.pluginIdentifiers[a.identifier]=!0,a=new a(this.window,{_livereload:this,
_reloader:this.reloader,_connector:this.connector,console:this.console,Timer:r,generateCacheBustUrl:function(a){return b.reloader.generateCacheBustUrl(a)}}),this.plugins.push(a),this.reloader.addPlugin(a))};b.prototype.analyze=function(){var a,b,f,e,d,g;if(7<=this.connector.protocol){f={};g=this.plugins;e=0;for(d=g.length;e<d;e++)a=g[e],f[a.constructor.identifier]=b=("function"===typeof a.analyze?a.analyze():void 0)||{},b.version=a.constructor.version;this.connector.sendCommand({command:"info",plugins:f,
url:this.window.location.href})}};return b}();var G;p=y;n=window.LiveReload=new q(window);for(G in window)G.match(/^LiveReloadPlugin/)&&n.addPlugin(window[G]);n.addPlugin(s);n.on("shutdown",function(){return delete window.LiveReload});n.on("connect",function(){return p.fire(document,"LiveReloadConnect")});n.on("disconnect",function(){return p.fire(document,"LiveReloadDisconnect")});p.bind(document,"LiveReloadShutDown",function(){return n.shutDown()})})();
